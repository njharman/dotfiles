#!/bin/bash
# http://wiki.opscode.com/display/chef/Installing+Chef+Client+on+Ubuntu+or+Debian

echo "deb http://apt.opscode.com/ `lsb_release -cs`-0.10 main" | sudo tee /etc/apt/sources.list.d/opscode.list

sudo mkdir -p /etc/apt/trusted.gpg.d
gpg --keyserver keys.gnupg.net --recv-keys 83EF826A
gpg --export packages@opscode.com | sudo tee /etc/apt/trusted.gpg.d/opscode-keyring.gpg > /dev/null

sudo aptitude update
sudo aptitude install opscode-keyring
sudo aptitude upgrade

sudo aptitude install chef
#https://chef.r.mutualmobile.com
/etc/init.d/chef-client stop
rm /etc/rc*.d/S*chef-client*
#scp /etc/chef/validation.pem /etc/chef/encrypted_data_bag_secret host:
chmod 600 /etc/chef/validation.pem /etc/chef/encrypted_data_bag_secret

vim /etc/hostname /etc/hosts
#hostname foo
chef-client
